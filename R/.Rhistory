theme_bw()
mod5_resid <- augment(mod5)
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
xlim(0, 550000000) +
theme_bw()
mod5_resid <- augment(mod5)
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
xlim(0, 400000000) +
theme_bw()
mod5_resid <- augment(mod5)
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
xlim(0, 200000000) +
theme_bw()
mod5_resid <- augment(mod5)
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
xlim(0, 100000000) +
theme_bw()
mod5_resid <- augment(mod5)
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
xlim(0, need_philly_total) +
theme_bw()
mod5_resid <- augment(mod5)
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(log_TOTAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(log(philly_facilities$TOTAL_OFFICIAL_NEED))), color="#a02300") +
theme_bw()
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 1000000000) +
theme_bw()
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 750000000) +
theme_bw()
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, need_philly_mean+1000000) +
theme_bw()
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 200000000) +
theme_bw()
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
gg5rescut <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 200000000) +
theme_bw()
grid.arrange(gg5resfull, gg5rescut, ncol = 2)
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
gg5rescut <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 200000000) +
theme_bw()
grid.arrange(gg5resfull, gg5rescut, ncol = 2)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
gg5rescut <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals (Cropped)") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 200000000) +
theme_bw()
grid.arrange(gg5resfull, gg5rescut, ncol = 2)
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw(legend.position = "top")
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
gg5rescut <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals (Cropped)") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 200000000) +
theme_bw()
grid.arrange(gg5resfull, gg5rescut, ncol = 2)
print('VIF')
vif(mod5) # variance inflation factors
print('sqrt(VIF)')
sqrt(vif(mod5))
View(cwns2012)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + res_pop10_dens*CSS,
data = cwns2012)
summary(mod5)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + res_pop10_dens:CSS,
data = cwns2012)
summary(mod5)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + res_pop10_dens*CSS,
data = cwns2012)
summary(mod5)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + CSS + res_pop10_dens:CSS,
data = cwns2012)
summary(mod5)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + res_pop10_dens*CSS,
data = cwns2012)
summary(mod5)
print('VIF')
vif(mod5) # variance inflation factors
print('sqrt(VIF)')
sqrt(vif(mod5))
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + CSS + res_pop10_dens:CSS,
data = cwns2012)
summary(mod5)
print('VIF')
vif(mod5) # variance inflation factors
print('sqrt(VIF)')
sqrt(vif(mod5))
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + CSS + res_pop10_dens:CSS,
data = cwns2012)
summary(mod5)
stargazer(mod1, mod2, mod3, mod4, mod5, type="html", digits = 2, single.row = FALSE)
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
gg5rescut <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals (Cropped)") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 200000000) +
theme_bw()
grid.arrange(gg5resfull, gg5rescut, ncol = 2)
View(philly_facilities)
550,000,000
average(philly_facilities$PRES_RES_REC_TRMT)
mean(philly_facilities$PRES_RES_REC_TRMT)
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
gg5rescut <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals (Cropped)") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 200000000) +
theme_bw()
grid.arrange(gg5resfull, gg5rescut, ncol = 2)
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
gg5rescut <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals (Cropped)") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 200000000) +
theme_bw()
grid.arrange(gg5resfull, gg5rescut, ncol = 2)
getJenksBreaks(cwns2012$MEDINC09, 4)
getJenksBreaks(cwns2012$POP10, 5)
cwns2012 <- cwns2012 %>%
mutate(GrowingCity = ifelse(POP10-POP80 > 0, 1, 0)) %>%
mutate(lowincome = ifelse(MEDINC09 <= 54728, 1, 0)) %>%
mutate(lrgcity = ifelse(POP10 >=1000000, 1, 0)) #Cutoff of 1,000,000 to capture Philly
bimod3 <- lm(TOTAL_OFFICIAL_NEED ~ CSS, data = cwns2012)
summary(bimod3)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + CSS + res_pop10_dens:CSS,
data = cwns2012)
summary(mod5)
mod3 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + res_pop10_dens + CSS + LogPOP10 + lowincome + GrowingCity, data = cwns2012)
summary(mod3)
#AIC
# Particularly helpful for backwards selection
# it's a measure of the quality of a model and used to pick a model from many.
# AIC is all relative - just tells you what's the best one you have.
# the preferred model has the lowest AIC. And AIC increases with the number of explanatory variables.
step(mod3, direction = "backward")
mod4 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + CSS + res_pop10_dens:CSS + LogPOP10 + LogMEDINC09 + GrowingCity,
data = cwns2012)
summary(mod4)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + CSS + res_pop10_dens:CSS + GrowingCity,
data = cwns2012)
summary(mod5)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + CSS + res_pop10_dens:CSS,
data = cwns2012)
summary(mod5)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + CSS + res_pop10_dens:CSS + GrowingCity,
data = cwns2012)
summary(mod5)
mod5 <- lm (TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT + CSS + res_pop10_dens:CSS + GrowingCity,
data = cwns2012)
summary(mod5)
stargazer(mod1, mod2, mod3, mod4, mod5, type="html", digits = 2, single.row = FALSE)
print('VIF')
vif(mod5) # variance inflation factors
print('sqrt(VIF)')
sqrt(vif(mod5))
#fitted values are predicted values (in this case, need)
mod5_resid <- augment(mod5)
gg5resfull <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
gg5rescut <- ggplot(mod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Model 5 Residuals (Cropped)") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
xlim(0, 200000000) +
theme_bw()
grid.arrange(gg5resfull, gg5rescut, ncol = 2)
stargazer(mod1, mod2, mod3, mod4, mod5, type="html", digits = 2, single.row = FALSE)
#make matrix of variables we're testing
mod_vars <- cwns2012 %>%
dplyr::select(TOTAL_OFFICIAL_NEED, log_TOTAL_NEED, res_pop10_dens, res_pop_dens_chng_80_10,
proj_change_res_rec_trmt, proj_change_res_rec_collctn, POP10, MEDINC09,
ResBurden, LogResBurden, PRES_RES_REC_TRMT, PRES_RES_REC_COLLCTN, LogPOP10, LogMEDINC09,
PCTWHITE10, CSS, GrowingCity, lowincome, lrgcity)
#compute correlation matrix
cormatrix <- cor(mod_vars) %>%
round(., 2)
#plot a correlogram
corrplot(cormatrix, method = "circle", type = "lower", order = "hclust",
tl.col = "black", tl.srt = 45)
bimod1 <- lm(TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT, data = cwns2012)
bimod1_resid <- augment(mod5)
ggbimod1 <- ggplot(bimod1_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Bivariate Model 1 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
bimod1 <- lm(TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT, data = cwns2012)
bimod1_resid <- augment(mod5)
ggplot(bimod1_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Bivariate Model 1 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
geom_vline(aes(xintercept=mean(TOTAL_OFFICIAL_NEED)), color="#E1B93C") +
geom_vline(aes(xintercept=mean(philly_facilities$TOTAL_OFFICIAL_NEED)), color="#a02300") +
theme_bw()
bimod1 <- lm(TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT, data = cwns2012)
bimod1_resid <- augment(mod5)
ggplot(bimod1_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Bivariate Model 1 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod1 <- lm(TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT, data = cwns2012)
bimod1_resid <- augment(bimod1)
ggplot(bimod1_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Bivariate Model 1 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod2 <- lm(TOTAL_OFFICIAL_NEED ~ res_pop10_dens, data = cwns2012)
bimod2_resid <- augment(bimod2)
ggplot(bimod2_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Bivariate Model 1 Residuals") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod1 <- lm(TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT, data = cwns2012)
bimod1_resid <- augment(bimod1)
ggplot(bimod1_resid, aes(x = .fitted, y = .resid)) +
ggtitle("PRES_RES_REC_TRMT Regressed on Need") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod1 <- lm(TOTAL_OFFICIAL_NEED ~ PRES_RES_REC_TRMT, data = cwns2012)
bimod1_resid <- augment(bimod1)
ggplot(bimod1_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Present Residential Receiving Treatment Regressed on Need") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod2 <- lm(TOTAL_OFFICIAL_NEED ~ res_pop10_dens, data = cwns2012)
bimod2_resid <- augment(bimod2)
ggplot(bimod2_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Residential Pop Density Regressed on Need") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod3 <- lm(TOTAL_OFFICIAL_NEED ~ CSS, data = cwns2012)
bimod3_resid <- augment(bimod3)
ggplot(bimod3_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Combined Sewer System Regressed on Need") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod4 <- lm(TOTAL_OFFICIAL_NEED ~ LogPOP10, data = cwns2012)
bimod4_resid <- augment(bimod4)
ggplot(bimod4_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Log of Population 2010 Regressed on Need") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod5 <- lm(TOTAL_OFFICIAL_NEED ~ PCTWHITE10, data = cwns2012)
bimod5_resid <- augment(bimod5)
ggplot(bimod5_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Percent White 2010 Regressed on Need") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod6 <- lm(TOTAL_OFFICIAL_NEED ~ LogMEDINC09, data = cwns2012)
bimod6_resid <- augment(bimod6)
ggplot(bimod6_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Median Income 2009 Regressed on Need") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod7 <- lm(TOTAL_OFFICIAL_NEED ~ GrowingCity, data = cwns2012)
bimod7_resid <- augment(bimod7)
ggplot(bimod7_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Growing City Regressed on Need") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
bimod8 <- lm(TOTAL_OFFICIAL_NEED ~ lowincome, data = cwns2012)
bimod8_resid <- augment(bimod8)
ggplot(bimod8_resid, aes(x = .fitted, y = .resid)) +
ggtitle("Low Income City Regressed on Need") +
xlab("Fitted") + ylab("Residuals") +
geom_point(size=1, color="black", fill="#6496b4", shape=21, alpha=.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "#a02300") +
theme_bw()
